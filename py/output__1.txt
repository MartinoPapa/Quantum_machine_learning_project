============================================================
              QTGNN DIRECTED CONFIGURATION
============================================================
[DATASET SPLIT]
  Training Graphs:       250
  Validation Graphs:     10
  Test Graphs:           50
  Total Graphs:          310
  Target Fraud Ratio:    30.0%
------------------------------------------------------------
[GRAPH CONSTRUCTION]
  Sampled Min Edges:     8
  Nodes per Subgraph:    16
  Sampling Strategy:     BFS (Snowball) from Hubs
------------------------------------------------------------
[MODEL ARCHITECTURE]
  VQGC Layers:           2
  Betti Thresholds:      1
  Latent Dimension:      8
============================================================

Loading Node Pool from pool_nodes.pkl...
Filter active: Only loading edges connecting these 118220 nodes.
Loading and Filtering PS_20174392719_1491204439457_log.csv...
Scanned chunk 5... Graph size: 88636 edges
Scanned chunk 10... Graph size: 109076 edges
Global Pool Graph: 118220 nodes, 116220 edges.
Sampling 310 subgraphs (Target Fraud: 93)...
Sampling Plan -> Fraud: 93 | Normal: 217
  [Fraud] Collected 10/93
  [Fraud] Collected 20/93
  [Fraud] Collected 30/93
  [Fraud] Collected 40/93
  [Fraud] Collected 50/93
  [Fraud] Collected 60/93
  [Fraud] Collected 70/93
  [Fraud] Collected 80/93
  [Fraud] Collected 90/93
Phase 1 Complete. Collected 93 Fraud Graphs.
  [Normal] Collected 50/217
  [Normal] Collected 100/217
  [Normal] Collected 150/217
  [Normal] Collected 200/217
Phase 2 Complete. Collected 217 Normal Graphs.
Total Graphs Generated: 310 (Fraud: 93)
Split -> Train: 250 | Val (S_normal): 10 | Test: 50
Training Stats: Normal=178, Fraud=72

--- Starting Training ---
Epoch 1 | Loss: 2.8760
Epoch 2 | Loss: 3.5491
Epoch 3 | Loss: 67.8632
Epoch 4 | Loss: 90.0563
Epoch 5 | Loss: 2.6112
Epoch 6 | Loss: 2.9125
Epoch 7 | Loss: 2.5278
Epoch 8 | Loss: 8.1145
Epoch 9 | Loss: 2.4774
Epoch 10 | Loss: 40.1322
Epoch 11 | Loss: 2.0851
Epoch 12 | Loss: 2.1618
Epoch 13 | Loss: 2.0922
Epoch 14 | Loss: 2.1419
Epoch 15 | Loss: 11.6465
Epoch 16 | Loss: 1.0037
Epoch 17 | Loss: 1.0058
Epoch 18 | Loss: 1.0099
Epoch 19 | Loss: 1.0126
Epoch 20 | Loss: 1.0208
Epoch 21 | Loss: 1.0202
Epoch 22 | Loss: 1.0259
Epoch 23 | Loss: 1.0357
Epoch 24 | Loss: 1.0465
Epoch 25 | Loss: 1.0504

--- Populating S_normal and Calculating Threshold ---
Dynamic Threshold (Tau): 0.500000

--- Testing ---
Graph 068 | FRAUD  | Score: 0.406291 | Pred: 0
Phi(068) = tensor([ 0.1571,  2.1855,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.1875,  0.6875,  0.0000, -0.5000])
Graph 158 | NORMAL | Score: 0.000004 | Pred: 0
Phi(158) = tensor([ 0.1639,  2.1794,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 250 | NORMAL | Score: 0.000009 | Pred: 0
Phi(250) = tensor([ 0.1631,  2.1785,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 200 | NORMAL | Score: 0.000006 | Pred: 0
Phi(200) = tensor([ 0.1639,  2.1791,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 114 | NORMAL | Score: 0.000003 | Pred: 0
Phi(114) = tensor([ 0.1637,  2.1796,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 203 | NORMAL | Score: 0.000003 | Pred: 0
Phi(203) = tensor([ 0.1648,  2.1751,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 069 | FRAUD  | Score: 0.000003 | Pred: 0
Phi(069) = tensor([ 0.1645,  2.1712,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 219 | NORMAL | Score: 0.000001 | Pred: 0
Phi(219) = tensor([ 0.1641,  2.1733,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 155 | NORMAL | Score: 0.000000 | Pred: 0
Phi(155) = tensor([ 0.1632,  2.1829,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 013 | FRAUD  | Score: 0.000001 | Pred: 0
Phi(013) = tensor([ 0.1625,  2.1839,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 301 | NORMAL | Score: 0.000008 | Pred: 0
Phi(301) = tensor([ 0.1633,  2.1755,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 041 | FRAUD  | Score: 0.000014 | Pred: 0
Phi(041) = tensor([ 0.1641,  2.1778,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 016 | FRAUD  | Score: 2.115981 | Pred: 1
Phi(016) = tensor([0.1239, 2.3273, 1.0000, 0.0000, 0.0000, 1.0000, 1.0000, 0.0000, 0.0000,
        1.0000, 0.3125, 0.1875, 0.0000, 0.1250])
Graph 166 | NORMAL | Score: 0.000012 | Pred: 0
Phi(166) = tensor([ 0.1662,  2.1655,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 182 | NORMAL | Score: 0.000014 | Pred: 0
Phi(182) = tensor([ 0.1667,  2.1657,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 271 | NORMAL | Score: 0.000003 | Pred: 0
Phi(271) = tensor([ 0.1638,  2.1798,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 189 | NORMAL | Score: 0.000014 | Pred: 0
Phi(189) = tensor([ 0.1640,  2.1777,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 115 | NORMAL | Score: 0.000001 | Pred: 0
Phi(115) = tensor([ 0.1627,  2.1842,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 065 | FRAUD  | Score: 0.000003 | Pred: 0
Phi(065) = tensor([ 0.1645,  2.1749,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 015 | FRAUD  | Score: 0.000007 | Pred: 0
Phi(015) = tensor([ 0.1653,  2.1643,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 253 | NORMAL | Score: 0.000010 | Pred: 0
Phi(253) = tensor([ 0.1658,  2.1697,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 089 | FRAUD  | Score: 0.000000 | Pred: 0
Phi(089) = tensor([ 0.1629,  2.1817,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 031 | FRAUD  | Score: 0.000000 | Pred: 0
Phi(031) = tensor([ 0.1628,  2.1818,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 039 | FRAUD  | Score: 0.000015 | Pred: 0
Phi(039) = tensor([ 0.1643,  2.1771,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 091 | FRAUD  | Score: 0.000003 | Pred: 0
Phi(091) = tensor([ 0.1668,  2.1604,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 060 | FRAUD  | Score: 0.000000 | Pred: 0
Phi(060) = tensor([ 0.1626,  2.1838,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 293 | NORMAL | Score: 0.000012 | Pred: 0
Phi(293) = tensor([ 0.1641,  2.1780,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 126 | NORMAL | Score: 0.000002 | Pred: 0
Phi(126) = tensor([ 0.1626,  2.1849,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 280 | NORMAL | Score: 0.000005 | Pred: 0
Phi(280) = tensor([ 0.1673,  2.1598,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 212 | NORMAL | Score: 0.000007 | Pred: 0
Phi(212) = tensor([ 0.1637,  2.1788,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 051 | FRAUD  | Score: 0.000000 | Pred: 0
Phi(051) = tensor([ 0.1648,  2.1733,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 261 | NORMAL | Score: 0.000017 | Pred: 0
Phi(261) = tensor([ 0.1642,  2.1773,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 003 | FRAUD  | Score: 0.000001 | Pred: 0
Phi(003) = tensor([ 0.1674,  2.1611,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 180 | NORMAL | Score: 0.000020 | Pred: 0
Phi(180) = tensor([ 0.1653,  2.1683,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 193 | NORMAL | Score: 0.000000 | Pred: 0
Phi(193) = tensor([ 0.1646,  2.1735,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 162 | NORMAL | Score: 0.000001 | Pred: 0
Phi(162) = tensor([ 0.1634,  2.1807,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 106 | NORMAL | Score: 0.000012 | Pred: 0
Phi(106) = tensor([ 0.1643,  2.1767,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 117 | NORMAL | Score: 0.000000 | Pred: 0
Phi(117) = tensor([ 0.1628,  2.1829,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 002 | FRAUD  | Score: 0.000009 | Pred: 0
Phi(002) = tensor([ 0.1641,  2.1785,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 285 | NORMAL | Score: 0.000000 | Pred: 0
Phi(285) = tensor([ 0.1627,  2.1837,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 181 | NORMAL | Score: 0.000001 | Pred: 0
Phi(181) = tensor([ 0.1627,  2.1823,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 222 | NORMAL | Score: 0.000000 | Pred: 0
Phi(222) = tensor([ 0.1672,  2.1617,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 134 | NORMAL | Score: 0.000113 | Pred: 0
Phi(134) = tensor([ 0.1694,  2.1517,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 007 | FRAUD  | Score: 0.000000 | Pred: 0
Phi(007) = tensor([ 0.1628,  2.1818,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 007 | FRAUD  | Score: 0.000000 | Pred: 0
Phi(007) = tensor([ 0.1628,  2.1818,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 007 | FRAUD  | Score: 0.000000 | Pred: 0
Phi(007) = tensor([ 0.1628,  2.1818,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
Graph 007 | FRAUD  | Score: 0.000000 | Pred: 0
Phi(007) = tensor([ 0.1628,  2.1818,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 218 | NORMAL | Score: 0.000001 | Pred: 0
Phi(218) = tensor([ 0.1625,  2.1840,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 207 | NORMAL | Score: 0.000001 | Pred: 0
Phi(207) = tensor([ 0.1652,  2.1718,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 306 | NORMAL | Score: 0.000007 | Pred: 0
Phi(306) = tensor([ 0.1652,  2.1701,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 274 | NORMAL | Score: 0.000011 | Pred: 0
Phi(274) = tensor([ 0.1641,  2.1764,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 298 | NORMAL | Score: 0.000010 | Pred: 0
Phi(298) = tensor([ 0.1640,  2.1762,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])
Graph 214 | NORMAL | Score: 0.000007 | Pred: 0
Phi(214) = tensor([ 0.1637,  2.1789,  1.0000,  0.0000,  0.0000,  1.0000,  1.0000,  0.0000,
         0.0000,  1.0000,  0.0625,  1.0625,  0.0000, -1.0000])

Final Accuracy: 70.0%
Confusion Matrix: TP=1, FP=0, TN=34, FN=15